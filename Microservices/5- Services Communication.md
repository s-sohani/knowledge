مواردی که هنگام طراحی ارتباط بین سرویس ها باید در نظر بگیریم:
1- استفاده از روش مناسب sync یا async
2- استفاده از فرمت پیام مناسب
3- روش تعامل(مثلا یک به چنده، پیام ارسال شد ارتباط تموم میشه یا باید منتظر جواب بمونه) و تکامل api

اهمیت روش تعامل
1- تاثیر روی دسترس پذیری
2- تاثیر روی تست و صحبت سنجی
3- تاثیر روی مدیریت تراکنش و  transactiona

دسته بندی روش های تعامل
1- یک به یک 
2- یک به چند (بین یک سرویس و چند سرویس دیگر)

روش های تعامل از نظر نوع
1- روش sync
2- روش async


![[photo_5805412611905405900_y.jpg]]



توی دنیای میکروسرویس بهتره از روش api first استفاده کینم  یعنی اول api رو طراحی کنیم و توافق کنیم با کلاینت ها بعد بیایم اپلیکیشن رو توسعه بدیم. اگر اینترفیس را در میکروسرویس عوض کنیم چون هر api رو تعداد تیم ها و سرویس های زیادی دارن استفاده میکنن تغییر توش باعث میشه سرویس های دیگه تحت تاثیر قرار بگیرند.


تکامل apiها:
در طول زمان ممکنه api تغییر کنه. تعداد ورودی و خروجی و یا نوع خروجی. چون تعداد سرویس های زیادی دارن ازش استفاده میکنن نباید این حرکت ناگهانی انجام بشه. توی دنیا برای این کار از ورژن زدن استفاده میکنن (rolling update) همچنین api ها تا جای امکان باید backward compatible باشد. 

نحوه نسخه زدن معنایی:

**1.2.3-beta**

1- اگر تغییر داشته باشیم که breaking change باشه یعنی کاربران با کد قبلیشون دیگه نمیتونن از api جدید استفاده کنن (Major)
2- اگر نسخه جدید backward compatible بود. مثلا اگر پارامتری میگیریم مقدار دیفالت داشته باشه تا اگر کسی ورودی نداد بهش کار کنه. یا اگر خروجی میدیم توصیف مناسب داشته باشه تا دریافت کننده بتونه ازش استفاده کنه. (Minor)
3- رفع خطایی که backward compatible  باشه. (Patch)


فرمت پیام:
ممکنه فرمت پیام در زبان های مختلف پشتیبانی شود یا نوش. 