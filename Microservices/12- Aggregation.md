هر Entity علاوه بر اینکه یک سری پراپرتی و رفتار داره ارتباط با اشیا دیگه هم دارند مثل value object  و یا رابطه با entity های دیگه. مثل ارتباط مشتری با سفارش یا ارتباطش با اجزا سفارش. اینکه ارتباط یک طرفه باشه یا دوطرفه باشه یا اندازه ارتباط چقدر باشه مهمه چون اینا طول عمر یکسانی باید داشته باشن و با هم ساخته شوند و با هم پاک شوند. 


برنامه نویس های سنتی اولش که بخوان اپلیکیشن رو پیاده سازی کنند اول میرن دنبال اجزا اطلاعاتی که اصطلاحا میگن اپلیکیشن data sentric ولی ما میخوایم اپلیکیشن هایی توسعه بدیم که domain sentric هستند یعنی به جای تمرکز روی داده ها روی رفتار ها تمرکز میکنیم و میایم رفتار ها رو در قالب entity پیاده سازی میکنیم که هر کدوم از موجودیت ها خودشون یک سری value object دارند. 
ولی وقتی داریم entity ها رو پیاده سازی میکنیم یک سری از رفتار ها وابسته به نوع ارتباطی هست که entity ها با هم دیگه دارند. تو این سطح نباید به رابطه دیتابیسی فکر کرد چون ممکنه دیتابیس document base باشه و ریلیشن نداشته باشه. اینجا منظور رابطه اشیا با هم هست. 

این ارتباط ها میتونن پیچیدگی اپلیکیشن رو کم یا زیاد کنند. مثلا یکی از اجزا ماشین به تنهایی درست کار میکنه ولی مهم این هست در کنار اجزا دیگه هم درست کار کنه. 

پیاده سازی entity ها از طریق دنیای واقعی پیچیده هست و گاها پیاده سازی رابطه ها باعث میشه یک loop ایجاد بشه. 

پس علاوه بر اینکه به entity ها و رفتارهاشون ارائه میدن باید توجه کنیم به نوع و تعداد و جهت و نحوه برقراری ارتباطات هم باید توجه کنیم. 

مثلا اگر ارتباط لیست Orderline ها رو در کلاس Order داشته باشیم میتونیم مجموع سفارشات رو محاسبه کنیم ولی اگر نداشته باشیمش نمیتونیم این جمع رو انجام بدیم. 

پس ارتباط درست باعث میشه یک سری رفتار رو بتونیم داشته باشیم. 
توی این ارتباط ها لازم هست که یک entity با ارتباط هاش به صورت transactional با هم ذخیره بشن و با هم واکشی بشن تا اطلاعاتمون consistence باشن. که کار خیلی سختی هست چون ممکنه فضا concurrent یا parallel باشه و باعث بشه تراکنش fail بشه (چون یکی زودتر اومده یک رکوردی که دست تو بوده رو تغییر داده) و تمام کارهایی که کاربر در یک thread انجام داده از دست بره و دوباره باید انجام بشه.

تو این سطح دیتابیس رو باید بریزیم دور و باید به بیزنس رول ها توجه کنیم تا بتونیم گراف کوچیکی از روابط بسازیم. 

پس اگریگیت میاد یک سری اشیا رو کنار هم میذاره و یک گراف کوچیک میسازه تا پیاده سازی بیزنس رول ها راحت تر بشه. مثلا bounded context ها که اپلیکیشن رو میشکوند به اجزاء کوچیک aggregate هم میاد همین کار رو میکنه و هر context رو میشکونه به یک سری گراف کوچیک 


ما وقتی یک اپلیکیشن رو پیاده سازی میکنیم دوتا فضا دایم یکی فضای دامنه و یکی فضای دیتا. ما کلا روی فضای دامنه تمرکز میکنیم domain model رو میسازیم و Data model رو میسپاریم به ORMها. مثلا یک کلاسی که داریم برای ما دیگه اهمیتی نداره که foreign key داره یا نداره این رو ORM میاد هندل میکنه. 

خیلی از افرادی که تازه کار هستند سعی میکنن پراپرتی و رفتار رو استخراج کنن و پیاده کنند و به ارتباطات توجهی ندارند یا ارتباط های ضعیف میسازن. اینجا ما میخوایم بدونیم وقتی یک گراف آبجکت داریم چطوری میتونیم کوچیک و با ارتباط های قوی ایجاد کنیم. 


ارتباط یک طرفه:
در دنیای واقعی کلی روابط دو طرفه وجود داره. ولی در دنیای برنامه نویسی باید از این فرار کنیم و روابط رو یک طرفه کنیم. اگر data model رو نگاه کنیم ارتباط ها دو طرفه میشن اکثرا ولی اگر به صورت domain model نگاه کنیم باید سعی کنیم روابط رو یک طرفه کنیم. 
پس اولین گام این هست که روابط دو طرفه رو حذف کنیم.  مثلا یک کلاس product داریم و یک کلاس discount داریم لازم نیست هر دو یک شی از هم توشون داشته باشن. بسته به اینکه چه رفتاری میخوام پیاده کنیم یکیش کافیه

گاهی میبینیم برای ایجاد ارتباط در پایگاه داده یا نمایش در UI میایم روابط جدید ایجاد میکنیم. مراقب باشیم برای اینطور نیازمندیها هیچ موقع رابطه در domain model ایجاد نکنیم و فقط یک زمانی که بیزنس رول میخواد این رابطه رو ایجاد کنیم. 
باید همش از خودمون سوال کنیم با گذاشتن یا نذاشتن این رابطه کدام رول رو میتونیم پیاده کنیم یا کدام رول رو نمیتونیم پیاده کنیم. 

داشتن ارجاع و رابطه برای مدل دامنه ضروریه ولی باید کنترلش کنیم. مثلا رابطه یک به چند که روز به روز داره بزرگ تر میشه به جایی میرسه که مثلا یک فرد هزاران پرداخت اعتباری خواهد داشت اگر بیایم همه هزارتا رابطه رو از پایگاه داده واکشی کنیم به مشکل مبخوریم. پس باید این رابطه رو کنترل هم بکنیم مثلا 
